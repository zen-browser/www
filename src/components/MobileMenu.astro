---
import Button from '~/components/Button.astro'
import ArrowRightIcon from '~/icons/ArrowRightIcon.astro'
import { getLocale, getPath, getUI } from '~/utils/i18n'

const locale = getLocale(Astro)
const getLocalePath = getPath(locale)
const {
  components: {
    nav: { menu },
  },
} = getUI(locale)

const menuItems = [
  {
    section: menu.gettingStarted,
    links: [
      { href: getLocalePath('/mods'), text: menu.zenMods },
      { href: getLocalePath('/release-notes'), text: menu.releaseNotes },
      { href: 'https://discord.gg/zen-browser', text: menu.discord },
    ],
  },
  {
    section: menu.usefulLinks,
    links: [
      { href: getLocalePath('/donate'), text: menu.donate },
      { href: getLocalePath('/about'), text: menu.aboutUs },
      { href: 'https://docs.zen-browser.app', text: menu.documentation },
      { href: 'https://github.com/zen-browser', text: menu.github, target: '_blank' },
    ],
  },
]
---

<!-- Hidden checkbox for menu toggle -->
<input type="checkbox" id="mobile-menu-toggle" class="peer sr-only lg:hidden" aria-hidden="true" />

<!-- Mobile Slide Menu -->
<div
  id="mobile-menu"
  class="fixed inset-y-0 right-0 z-40 w-64 translate-x-full transform bg-paper shadow-lg transition-transform duration-300 peer-checked:translate-x-0 lg:hidden"
>
  <div class="flex items-center justify-between border-b border-dark px-6 py-4">
    <div class="text-lg font-bold tracking-tight">{menu.menu}</div>
    {/* eslint-disable-next-line jsx-a11y/label-has-associated-control */}
    <label for="mobile-menu-toggle" class="-mr-3 cursor-pointer p-3 text-dark">
      <span class="sr-only">Close menu</span>
      <svg
        xmlns="http://www.w3.org/2000/svg"
        class="h-5 w-5"
        fill="none"
        viewBox="0 0 24 24"
        stroke="currentColor"
        aria-hidden="true"
      >
        <path
          stroke-linecap="round"
          stroke-linejoin="round"
          stroke-width={2}
          d="M6 18L18 6M6 6l12 12"></path>
      </svg>
    </label>
  </div>

  <nav class="px-6 py-6">
    <ul>
      {
        menuItems.map((section, index) => (
          <li class={index > 0 ? 'pt-6' : ''}>
            <div class="mb-2 text-sm font-semibold uppercase tracking-wider opacity-65">
              {section.section}
            </div>
            <ul class="space-y-2">
              {section.links.map(link => (
                <li>
                  <a
                    href={link.href}
                    {...(link.target && { target: link.target })}
                    class="block text-lg font-medium text-dark hover:text-coral"
                  >
                    {link.text}
                  </a>
                </li>
              ))}
            </ul>
          </li>
        ))
      }

      <!-- Download Button -->
      <li class="pt-6">
        <Button href={getLocalePath('/download')} isPrimary>
          <span class="flex items-center gap-2 text-lg">
            {menu.download}
            <ArrowRightIcon class="size-5" />
          </span>
        </Button>
      </li>
    </ul>
  </nav>
</div>

<!-- Overlay for Mobile Menu -->
{/* eslint-disable-next-line jsx-a11y/label-has-associated-control */}
<label
  for="mobile-menu-toggle"
  class="pointer-events-none fixed inset-0 z-30 bg-black opacity-0 transition-opacity duration-300 peer-checked:pointer-events-auto peer-checked:opacity-50"
  aria-hidden="true"></label>
